{"version":3,"sources":["newnote.js"],"names":["getLocation","navigator","geolocation","getCurrentPosition","position","addPlacesMap","coords","latitude","longitude","accuracy","uncertainty","fetch","credentials","method","then","response","json","j","error","alertify","reset","error_description","places","length","i","latlng","parseLocation","location","name","uri","push","addMap","catch","err","console","arguments","form","button","parentNode","div","document","createElement","setAttribute","appendChild","L","mapbox","accessToken","map","setView","addLayer","tileLayer","detectRetina","marker","draggable","addTo","on","mapMarkerLatitude","getLatitudeFromMapboxMarker","getLatLng","mapMarkerLongitude","getLongitudeFromMapboxMarker","coordsOption","querySelector","value","placeFormLatitude","placeFormLongitude","selectEl","noLocation","createTextNode","geoLocation","insertBefore","forEach","item","option","text","dataset","placeMarker","icon","marker-size","marker-symbol","marker-color","bindPopup","closeButton","panTo","selectPlace","addEventListener","placeLat","selectedIndex","placeLon","newLocButton","nameLabel","classList","add","nameEl","descLabel","descEl","latLabel","latEl","lonLabel","lonEl","placeSubmit","formData","FormData","append","body","placeJson","Error","removeChild","labels","querySelectorAll","removeLayer","newOption","newPlaceMarker","newName","placeError","point","re","resultArray","exec","split","selected","replace","disabled"],"mappings":"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","file":"newnote.js","sourcesContent":["/* global L, alertify */\nif ('geolocation' in navigator) {\n    var button = document.querySelector('#locate');\n    if (button.addEventListener) {\n        //if we have javascript, event listeners and geolocation, make the locate\n        //button clickable and add event\n        button.disabled = false;\n        button.addEventListener('click', getLocation);\n    }\n}\n\nfunction getLocation() {\n    navigator.geolocation.getCurrentPosition(function (position) {\n        //the locate button has been clicked so add the places/map\n        addPlacesMap(position.coords.latitude, position.coords.longitude, position.coords.accuracy);\n    });\n}\n\nfunction addPlacesMap(latitude, longitude, uncertainty) {\n    //get the nearby places\n    fetch('/places/near/' + latitude + '/' + longitude + '?u=' + uncertainty, {\n        credentials: 'same-origin',\n        method: 'get'\n    }).then(function (response) {\n        return response.json();\n    }).then(function (j) {\n        if (j.error == true) {\n            alertify.reset();\n            alertify.error(j.error_description);\n        }\n        if (j.places.length > 0) {\n            var i;\n            var places = [];\n            for (i = 0; i < j.places.length; ++i) {\n                var latlng = parseLocation(j.places[i].location);\n                var name = j.places[i].name;\n                var uri = j.places[i].uri;\n                places.push([name, uri, latlng[0], latlng[1]]);\n            }\n            //add a map with the nearby places\n            addMap(latitude, longitude, places);\n        } else {\n            //add a map with just current location\n            addMap(latitude, longitude);\n        }\n    }).catch(function (err) {\n        console.error(err);\n    });\n}\n\nfunction addMap(latitude, longitude, places) {\n    //make places null if not supplied\n    if (arguments.length == 2) {\n        places = null;\n    }\n    var form = button.parentNode;\n    var div = document.createElement('div');\n    div.setAttribute('id', 'map');\n    //add the map div\n    form.appendChild(div);\n    L.mapbox.accessToken = 'pk.eyJ1Ijoiam9ubnliYXJuZXMiLCJhIjoiVlpndW1EYyJ9.aP9fxAqLKh7lj0LpFh5k1w';\n    var map = L.mapbox.map('map', 'jonnybarnes.gnoihnim')\n        .setView([latitude, longitude], 15)\n        .addLayer(L.mapbox.tileLayer('jonnybarnes.gnoihnim', {\n            detectRetina: true\n        }));\n    //add a marker for the current location\n    var marker = L.marker([latitude, longitude], {\n        draggable: true\n    }).addTo(map);\n    //when the location marker is dragged, if the new place form elements exist\n    //update the lat/lng values\n    marker.on('dragend', function () {\n        var mapMarkerLatitude = getLatitudeFromMapboxMarker(marker.getLatLng());\n        var mapMarkerLongitude = getLongitudeFromMapboxMarker(marker.getLatLng());\n        var coordsOption = document.querySelector('#option-coords');\n        if (coordsOption != null) {\n            coordsOption.value = 'geo:' + mapMarkerLatitude + ',' + mapMarkerLongitude;\n        }\n        var placeFormLatitude = document.querySelector('#place-latitude');\n        if (placeFormLatitude !== null) {\n            placeFormLatitude.value = mapMarkerLatitude;\n        }\n        var placeFormLongitude = document.querySelector('#place-longitude');\n        if (placeFormLongitude !== null) {\n            placeFormLongitude.value = mapMarkerLongitude;\n        }\n    });\n    //create the <select> element and give it a no location default\n    var selectEl = document.createElement('select');\n    selectEl.setAttribute('name', 'location');\n    var noLocation = document.createElement('option');\n    noLocation.setAttribute('value', 'no-location');\n    noLocation.appendChild(document.createTextNode('Donâ€™t send location'));\n    selectEl.appendChild(noLocation);\n    var geoLocation = document.createElement('option');\n    geoLocation.setAttribute('selected', 'selected');\n    geoLocation.setAttribute('id', 'option-coords');\n    geoLocation.setAttribute('value', 'geo:' + latitude + ',' + longitude);\n    geoLocation.appendChild(document.createTextNode('Send co-ordinates'));\n    selectEl.appendChild(geoLocation);\n    form.insertBefore(selectEl, div);\n    if (places !== null) {\n        //add the places both to the map and <select>\n        places.forEach(function (item) {\n            var option = document.createElement('option');\n            option.setAttribute('value', item[1]);\n            var text = document.createTextNode(item[0]);\n            option.appendChild(text);\n            option.dataset.latitude = item[2];\n            option.dataset.longitude = item[3];\n            selectEl.appendChild(option);\n            var placeMarker = L.marker([item[2], item[3]], {\n                icon: L.mapbox.marker.icon({\n                    'marker-size': 'large',\n                    'marker-symbol': 'building',\n                    'marker-color': '#fa0'\n                })\n            }).addTo(map);\n            var name = 'Name: ' + item[0];\n            placeMarker.bindPopup(name, {\n                closeButton: true\n            });\n            placeMarker.on('click', function () {\n                map.panTo([item[2], item[3]]);\n                selectPlace(item[1]);\n            });\n        });\n        //add an event listener\n        selectEl.addEventListener('change', function () {\n            if (selectEl.value !== 'no-location') {\n                var placeLat = selectEl[selectEl.selectedIndex].dataset.latitude;\n                var placeLon = selectEl[selectEl.selectedIndex].dataset.longitude;\n                map.panTo([placeLat, placeLon]);\n            }\n        });\n    }\n    //add a button to add a new place\n    var newLocButton = document.createElement('button');\n    newLocButton.setAttribute('type', 'button');\n    newLocButton.setAttribute('id', 'create-new-place');\n    newLocButton.appendChild(document.createTextNode('Create New Place?'));\n    //the event listener\n    newLocButton.addEventListener('click', function() {\n        //add the form elements\n        var nameLabel = document.createElement('label');\n        nameLabel.setAttribute('for', 'place-name');\n        nameLabel.classList.add('place-label');\n        nameLabel.appendChild(document.createTextNode('Place Name:'));\n        var nameEl = document.createElement('input');\n        nameEl.setAttribute('placeholder', 'Name');\n        nameEl.setAttribute('name', 'place-name');\n        nameEl.setAttribute('id', 'place-name');\n        nameEl.setAttribute('type', 'text');\n        var descLabel = document.createElement('label');\n        descLabel.setAttribute('for', 'place-description');\n        descLabel.classList.add('place-label');\n        descLabel.appendChild(document.createTextNode('Place Description:'));\n        var descEl = document.createElement('input');\n        descEl.setAttribute('placeholder', 'Description');\n        descEl.setAttribute('name', 'place-description');\n        descEl.setAttribute('id', 'place-description');\n        descEl.setAttribute('type', 'text');\n        var latLabel = document.createElement('label');\n        latLabel.setAttribute('for', 'place-latitude');\n        latLabel.classList.add('place-label');\n        latLabel.appendChild(document.createTextNode('Place Latitude:'));\n        var latEl = document.createElement('input');\n        latEl.setAttribute('name', 'place-latitude');\n        latEl.setAttribute('id', 'place-latitude');\n        latEl.setAttribute('type', 'text');\n        latEl.value = getLatitudeFromMapboxMarker(marker.getLatLng());\n        var lonLabel = document.createElement('label');\n        lonLabel.setAttribute('for', 'place-longitude');\n        lonLabel.classList.add('place-label');\n        lonLabel.appendChild(document.createTextNode('Place Longitude:'));\n        var lonEl = document.createElement('input');\n        lonEl.setAttribute('name', 'place-longitude');\n        lonEl.setAttribute('id', 'place-longitude');\n        lonEl.setAttribute('type', 'text');\n        lonEl.value = getLongitudeFromMapboxMarker(marker.getLatLng());\n        var placeSubmit = document.createElement('button');\n        placeSubmit.setAttribute('id', 'place-submit');\n        placeSubmit.setAttribute('value', 'Submit New Place');\n        placeSubmit.setAttribute('name', 'place-submit');\n        placeSubmit.setAttribute('type', 'button');\n        placeSubmit.appendChild(document.createTextNode('Submit New Place'));\n        form.appendChild(nameLabel);\n        form.appendChild(nameEl);\n        form.appendChild(descLabel);\n        form.appendChild(descEl);\n        form.appendChild(latLabel);\n        form.appendChild(latEl);\n        form.appendChild(lonLabel);\n        form.appendChild(lonEl);\n        form.appendChild(placeSubmit);\n        //the event listener for the new place form\n        placeSubmit.addEventListener('click', function () {\n            //create the form data to send\n            var formData = new FormData();\n            formData.append('place-name', document.querySelector('#place-name').value);\n            formData.append('place-description', document.querySelector('#place-description').value);\n            formData.append('place-latitude', document.querySelector('#place-latitude').value);\n            formData.append('place-longitude', document.querySelector('#place-longitude').value);\n            //post the new place\n            fetch('/places/new', {\n                //send cookies with the request\n                credentials: 'same-origin',\n                method: 'post',\n                body: formData\n            })\n            .then(function (response) {\n                return response.json();\n            })\n            .then(function (placeJson) {\n                if (placeJson.error == true) {\n                    throw new Error(placeJson.error_description);\n                }\n                //remove un-needed form elements\n                form.removeChild(document.querySelector('#place-name'));\n                form.removeChild(document.querySelector('#place-description'));\n                form.removeChild(document.querySelector('#place-latitude'));\n                form.removeChild(document.querySelector('#place-longitude'));\n                var labels = document.querySelectorAll('.place-label');\n                for (var i = 0; i < labels.length; ++i) {\n                    form.removeChild(labels[i]);\n                }\n                form.removeChild(document.querySelector('#place-submit'));\n                form.removeChild(document.querySelector('#create-new-place'));\n                //remove location marker\n                map.removeLayer(marker);\n                //add place marker\n                var newOption = document.createElement('option');\n                newOption.setAttribute('value', placeJson.uri);\n                newOption.appendChild(document.createTextNode(placeJson.name));\n                newOption.dataset.latitude = placeJson.latitude;\n                newOption.dataset.longitude = placeJson.longitude;\n                selectEl.appendChild(newOption);\n                var newPlaceMarker = L.marker([placeJson.latitude, placeJson.longitude], {\n                    icon: L.mapbox.marker.icon({\n                        'marker-size': 'large',\n                        'marker-symbol': 'building',\n                        'marker-color': '#fa0'\n                    })\n                }).addTo(map);\n                map.panTo([placeJson.latitude, placeJson.longitude]);\n                var newName = 'Name: ' + placeJson.name;\n                newPlaceMarker.bindPopup(newName, {\n                    closeButton: true\n                });\n                newPlaceMarker.on('click', function () {\n                    map.panTo([placeJson.latitude, placeJson.longitude]);\n                    selectPlace(placeJson.uri);\n                });\n                //make selected\n                selectPlace(placeJson.uri);\n            }).catch(function (placeError) {\n                alertify.reset();\n                alertify.error(placeError);\n            });\n        });\n    });\n    form.insertBefore(newLocButton, div);\n}\n\nfunction parseLocation(point) {\n    var re = /\\((.*)\\)/;\n    var resultArray = re.exec(point);\n    var location = resultArray[1].split(' ');\n\n    return [location[1], location[0]];\n}\n\nfunction selectPlace(uri) {\n    document.querySelector('select [value=\"' + uri + '\"]').selected = true;\n}\n\nfunction getLatitudeFromMapboxMarker(latlng) {\n    var resultArray = /\\((.*)\\)/.exec(latlng);\n    var location = resultArray[1].split(' ');\n\n    return location[0].replace(',', '');\n}\n\nfunction getLongitudeFromMapboxMarker(latlng) {\n    var resultArray = /\\((.*)\\)/.exec(latlng);\n    var location = resultArray[1].split(' ');\n\n    return location[1];\n}\n"],"sourceRoot":"/source/"}